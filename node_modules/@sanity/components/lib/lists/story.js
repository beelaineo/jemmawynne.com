"use strict";

var _range2 = _interopRequireDefault(require("lodash/range"));

var _react = _interopRequireDefault(require("react"));

var _storybook = require("part:@sanity/storybook");

var _default = require("part:@sanity/components/lists/default");

var _sortable = require("part:@sanity/components/lists/sortable");

var _reactSortableHoc = require("react-sortable-hoc");

var _chance = _interopRequireDefault(require("chance"));

var _knobs = require("part:@sanity/storybook/addons/knobs");

var _sanity = _interopRequireDefault(require("part:@sanity/storybook/addons/sanity"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

var chance = new _chance.default();
var containerStyle = {
  width: '90%',
  height: '90%',
  boxShadow: '0 0 10px #999',
  overflow: 'hidden',
  position: 'fixed',
  top: '50%',
  left: '50%',
  transform: 'translateX(-50%) translateY(-50%)'
};
var defaultItems = (0, _range2.default)(100).map((item, i) => {
  return {
    key: "".concat(i),
    title: chance.name()
  };
});

class SortableTester extends _react.default.Component {
  constructor(props, args) {
    super(props, args);

    _defineProperty(this, "handleOnSort", event => {
      var items = this.state.items;
      var oldIndex = event.oldIndex,
          newIndex = event.newIndex;
      this.setState({
        items: (0, _reactSortableHoc.arrayMove)(items, oldIndex, newIndex)
      });
      this.props.onSort(event);
    });

    this.state = {
      items: this.props.items.slice()
    };
  }

  render() {
    var items = this.state.items;
    return _react.default.createElement(_sortable.List, _extends({}, this.props, {
      onSort: this.handleOnSort
    }), items.map((item, index) => {
      return _react.default.createElement(_sortable.Item, {
        index: index,
        key: index
      }, _react.default.createElement(_sortable.DragHandle, null), item.title);
    }));
  }

}

(0, _storybook.storiesOf)('List').addDecorator(_knobs.withKnobs).add('Default', () => {
  return _react.default.createElement(_sanity.default, {
    part: "part:@sanity/components/lists/default",
    propTables: [_default.List]
  }, _react.default.createElement("div", {
    style: containerStyle
  }, _react.default.createElement(_default.List, null, defaultItems.map((item, index) => {
    return _react.default.createElement(_default.Item, {
      key: index
    }, item.title);
  }))));
}).add('Sortable', () => {
  return _react.default.createElement(_sanity.default, {
    part: "part:@sanity/components/lists/sortable",
    propTables: [_sortable.List]
  }, _react.default.createElement("div", {
    style: containerStyle
  }, _react.default.createElement(SortableTester, {
    items: defaultItems
  })));
});