{"version":3,"file":"slate-react-placeholder.es.js","sources":["../../../node_modules/tiny-invariant/dist/tiny-invariant.esm.js","../src/index.js"],"sourcesContent":["var isProduction = process.env.NODE_ENV === 'production';\nvar prefix = 'Invariant failed';\nvar index = (function (condition, message) {\n  if (condition) {\n    return;\n  }\n\n  if (isProduction) {\n    throw new Error(prefix);\n  } else {\n    throw new Error(prefix + \": \" + (message || ''));\n  }\n});\n\nexport default index;\n","import invariant from 'tiny-invariant'\nimport React from 'react'\n\n/*\n * Instance counter to enable unique marks for multiple Placeholder instances.\n */\n\nlet instanceCounter = 0\n\n/**\n * A plugin that renders a React placeholder for a given Slate node.\n *\n * @param {Object} options\n * @return {Object}\n */\n\nfunction SlateReactPlaceholder(options = {}) {\n  const instanceId = instanceCounter++\n  const placeholderMark = {\n    type: 'placeholder',\n    data: { key: instanceId },\n  }\n\n  const { placeholder, when, style = {} } = options\n\n  invariant(\n    placeholder,\n    'You must pass `SlateReactPlaceholder` an `options.placeholder` string.'\n  )\n\n  invariant(\n    when,\n    'You must pass `SlateReactPlaceholder` an `options.when` query.'\n  )\n\n  /**\n   * Decorate a match node with a placeholder mark when it fits the query.\n   *\n   * @param {Node} node\n   * @param {Editor} editor\n   * @param {Function} next\n   * @return {Array}\n   */\n\n  function decorateNode(node, editor, next) {\n    if (!editor.query(when, node)) {\n      return next()\n    }\n\n    const others = next()\n    const document = editor.value.document\n    const first = node.getFirstText()\n    const last = node.getLastText()\n    const decoration = {\n      anchor: { key: first.key, offset: 0, path: document.getPath(first.key) },\n      focus: {\n        key: last.key,\n        offset: last.text.length,\n        path: document.getPath(last.key),\n      },\n      mark: placeholderMark,\n    }\n\n    return [...others, decoration]\n  }\n\n  /**\n   * Render an inline placeholder for the placeholder mark.\n   *\n   * @param {Object} props\n   * @param {Editor} editor\n   * @param {Function} next\n   * @return {Element}\n   */\n\n  function renderMark(props, editor, next) {\n    const { children, mark } = props\n\n    if (mark.type === 'placeholder' && mark.data.get('key') === instanceId) {\n      const placeHolderStyle = {\n        pointerEvents: 'none',\n        display: 'inline-block',\n        width: '0',\n        maxWidth: '100%',\n        whiteSpace: 'nowrap',\n        opacity: '0.333',\n        ...style,\n      }\n\n      return (\n        <span>\n          <span contentEditable={false} style={placeHolderStyle}>\n            {placeholder}\n          </span>\n          {children}\n        </span>\n      )\n    }\n\n    return next()\n  }\n\n  /**\n   * Return the plugin.\n   *\n   * @return {Object}\n   */\n\n  return { decorateNode, renderMark }\n}\n\n/**\n * Export.\n *\n * @type {Function}\n */\n\nexport default SlateReactPlaceholder\n"],"names":["instanceCounter","SlateReactPlaceholder","options","instanceId","placeholderMark","key","placeholder","when","style","decorateNode","node","editor","next","query","others","document","value","first","getFirstText","last","getLastText","decoration","offset","path","getPath","text","length","renderMark","props","children","mark","type","data","get","placeHolderStyle"],"mappings":";;AAAA,IAAI,YAAY,GAAG,aAAoB,KAAK,YAAY,CAAC;AACzD,IAAI,MAAM,GAAG,kBAAkB,CAAC;AAChC,IAAI,KAAK,IAAI,UAAU,SAAS,EAAE,OAAO,EAAE;EACzC,IAAI,SAAS,EAAE;IACb,OAAO;GACR;;EAED,IAAI,YAAY,EAAE;IAChB,MAAM,IAAI,KAAK,CAAC,MAAM,CAAC,CAAC;GACzB,MAAM;IACL,MAAM,IAAI,KAAK,CAAC,MAAM,GAAG,IAAI,IAAI,OAAO,IAAI,EAAE,CAAC,CAAC,CAAC;GAClD;CACF,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACTF;;;;AAIA,IAAIA,kBAAkB,CAAtB;;;;;;;;;AASA,SAASC,qBAAT,GAA6C;MAAdC,OAAc,uEAAJ,EAAI;;MACrCC,aAAaH,iBAAnB;MACMI,kBAAkB;UAChB,aADgB;UAEhB,EAAEC,KAAKF,UAAP;GAFR;;MAKQG,WAPmC,GAODJ,OAPC,CAOnCI,WAPmC;MAOtBC,IAPsB,GAODL,OAPC,CAOtBK,IAPsB;uBAODL,OAPC,CAOhBM,KAPgB;MAOhBA,KAPgB,kCAOR,EAPQ;;;QAUzCF,WADF,EAEE,wEAFF;;QAMEC,IADF,EAEE,gEAFF;;;;;;;;;;;WAcSE,YAAT,CAAsBC,IAAtB,EAA4BC,MAA5B,EAAoCC,IAApC,EAA0C;QACpC,CAACD,OAAOE,KAAP,CAAaN,IAAb,EAAmBG,IAAnB,CAAL,EAA+B;aACtBE,MAAP;;;QAGIE,SAASF,MAAf;QACMG,WAAWJ,OAAOK,KAAP,CAAaD,QAA9B;QACME,QAAQP,KAAKQ,YAAL,EAAd;QACMC,OAAOT,KAAKU,WAAL,EAAb;QACMC,aAAa;cACT,EAAEhB,KAAKY,MAAMZ,GAAb,EAAkBiB,QAAQ,CAA1B,EAA6BC,MAAMR,SAASS,OAAT,CAAiBP,MAAMZ,GAAvB,CAAnC,EADS;aAEV;aACAc,KAAKd,GADL;gBAEGc,KAAKM,IAAL,CAAUC,MAFb;cAGCX,SAASS,OAAT,CAAiBL,KAAKd,GAAtB;OALS;YAOXD;KAPR;;uCAUWU,MAAX,IAAmBO,UAAnB;;;;;;;;;;;;WAYOM,UAAT,CAAoBC,KAApB,EAA2BjB,MAA3B,EAAmCC,IAAnC,EAAyC;QAC/BiB,QAD+B,GACZD,KADY,CAC/BC,QAD+B;QACrBC,IADqB,GACZF,KADY,CACrBE,IADqB;;;QAGnCA,KAAKC,IAAL,KAAc,aAAd,IAA+BD,KAAKE,IAAL,CAAUC,GAAV,CAAc,KAAd,MAAyB9B,UAA5D,EAAwE;UAChE+B;uBACW,MADX;iBAEK,cAFL;eAGG,GAHH;kBAIM,MAJN;oBAKQ,QALR;iBAMK;SACN1B,KAPC,CAAN;;aAWE;;;;;YACQ,iBAAiB,KAAvB,EAA8B,OAAO0B,gBAArC;;SADF;;OADF;;;WAUKtB,MAAP;;;;;;;;;SASK,EAAEH,0BAAF,EAAgBkB,sBAAhB,EAAP;;;;;"}