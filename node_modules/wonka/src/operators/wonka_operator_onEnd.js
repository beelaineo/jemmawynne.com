

import * as Block from "bs-platform/lib/es6/block.js";
import * as Curry from "bs-platform/lib/es6/curry.js";

function onEnd(f) {
  return (function (source) {
      return (function (sink) {
          var ended = /* record */[/* contents */false];
          return Curry._1(source, (function (signal) {
                        if (typeof signal === "number") {
                          if (ended[0]) {
                            return 0;
                          } else {
                            ended[0] = true;
                            sink(signal);
                            return f();
                          }
                        } else if (signal.tag) {
                          return sink(signal);
                        } else {
                          var talkback = signal[0];
                          return sink(/* Start */Block.__(0, [(function (signal) {
                                            if (signal) {
                                              if (ended[0]) {
                                                return /* () */0;
                                              } else {
                                                ended[0] = true;
                                                return f();
                                              }
                                            } else {
                                              return talkback(/* Pull */0);
                                            }
                                          })]));
                        }
                      }));
        });
    });
}

export {
  onEnd ,
  
}
/* No side effect */
